<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Example</title>
    <script src="jsPDF-1.3.2/dist/jspdf.min.js"></script>
    <script src="html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.16/jspdf.plugin.autotable.min.js"></script>



</head>
<body>
    <button onclick="generatePDF()">Generate PDF</button>

    <!-- Element to render the barcode -->
    <svg id="barcode"></svg>

    <script>
        function generatePDF() {
            const doc = new jsPDF();
            doc.internal.scaleFactor = 2.25;


             // Header
             doc.setFontSize(20);
            doc.text("Header", 80, 15);


            const headers = [["Dimensiones", "Diámetro longitudinal", "Diámetro anteroposterior", "Diámetro transversal", "Espesor cortical"]];
            const data = [
                ["Riñón derecho", "mm", "mm", "mm", "mm"],
                ["Riñón izquierdo", "mm", "mm", "mm", "mm"]
               
            ];

            doc.autoTable({
                startY: 40,
                head: headers,
                body: data
            });

            // Adding text
            //doc.text("Professional PDF Example", 10, 10);

            // Adding an image
            const img = new Image();
            img.crossOrigin = "Anonymous";
            img.src = 'love.png';
            const imgWidth = 60;
            const imgHeight = 60;
            const startX = (doc.internal.pageSize.width - imgWidth) / 2;
            const startY = doc.autoTable.previous.finalY + 10; // Place the image 10 units below the end of the table

            img.onload = function() {
                doc.addImage(img, 'PNG', startX, startY, imgWidth, imgHeight);

                // Adding a barcode
                JsBarcode("#barcode", "Hello World!", {
                    format: "CODE128",
                    displayValue: true
                });


                doc.autoTable.previous.finalY + startY + 500;
                // Adding barcode to PDF
                const barcodeSVG = document.querySelector('#barcode');
                const svgData = barcodeSVG.outerHTML;
                const imgBarcode = new Image();
                imgBarcode.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgData)));



                doc.autoTable.previous.finalY + startY + 500;
                
                imgBarcode.onload = function() {
                    const canvasBarcode = document.createElement('canvas');
                    canvasBarcode.width = imgBarcode.width;
                    canvasBarcode.height = imgBarcode.height;
                    const contextBarcode = canvasBarcode.getContext('2d');
                    contextBarcode.drawImage(imgBarcode, 0, 0);
                    const imageDataBarcode = canvasBarcode.toDataURL('image/png');
                    doc.addImage(imageDataBarcode, 'PNG', 15, 120, 100, 30);

                    // Save PDF
                    doc.save('professional_example.pdf');
                };

                // Footer
               const pageCount = doc.internal.getNumberOfPages();
                    doc.setFontSize(10);
                    for (let i = 1; i <= pageCount; i++) {
                        doc.setPage(i);
                        doc.text(`Footer - Page ${i} of ${pageCount}`, 150, 285);
                    }

            }
        }
    </script>
</body>
</html>
